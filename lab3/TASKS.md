# Третья лабораторная работа.
### Тема: Реализация и анализ алгоритмов обучения многослойных нейронных сетей. Применение нейронных сетей для сжатия и восстановления образов.
### Цель: Ознакомиться, проанализировать и получить навыки реализации модели линейной рециркуляционной сети для задачи сжатия графической (или другой) информации.

## Задание по третьей лабораторной работе по моделям решения задач в интеллектуальных системах.
### Дано:
1. текст методических указаний по лабораторной работе;
2. учебные материалы по программированию, основам нейросетевых моделей и другие;
3. номер варианта задачи.

### Требуется:
1. построить модель линейной рециркуляционной сети, реализующей решение задачи сжатия графических данных, удовлетворяющую нижеприведенным требованиям;
2. построить семейства графиков зависимостей параметров модели;
3. дать ответы на вопросы из списка;
4. предоставить письменный отчет.


## Требования к модели линейной рециркуляционной сети.

Для лабораторной работы в качестве данных исходного растрового изображения использовать файлы формата BMP.

Исходное изображение размером $h \times w$ (рекомендуемый размер не менее $256 \times 256$ пикселей) разбивается на $Q$ прямоугольников размерностью $r \times m$ ($r \cdot m = n/|S|$), где $4 \le r \le h$, $4 \le m \le w$. Значения $r$ и $m$ может указать пользователь.

Все прямоугольники должны полностью накрывать исходное изображение и не выходить за его границы. Может допускаться перекрытие прямоугольников, которое также может задать пользователь.

Пусть $C(k)[q][i][j]$ обозначает одно из значений цвета ($R, G, B$), где $0 \le q < |S|$, и принимает значения в диапазоне $0 \le C(k)[q][i][j] \le 255 = C_{max}$ ($i, j$ -- координаты пикселя).

Для того, чтобы использовать значения цвета пикселя исходного изображения для дальнейшей обработки, следует выполнить преобразование:

$$
c(k)[q][i][j] = \frac{2 \cdot C(k)[q][i][j]}{C_{max}} - 1 \quad (1)
$$

где $c(k)[q][i][j]$ — это значение цвета пикселя для дальнейших преобразований.

Так преобразуются все значения пикселей для всех прямоугольников.
Значения цвета пикселей из прямоугольника $k$ собираются в свой (эталонный) вектор $X(k)$, компоненты которого вычисляются в соответствии с выражением $X(k)[0][q+|S|\cdot(j+m\cdot i)] = c(k)[q][i][j]$, где целые неотрицательные $0 \le i < r$, $0 \le j < m$. То есть число элементов будет равно $n$, где $X(k)$ — это матрица размера $1 \times n$, а её значения после преобразований уже будут $|X(k)[q][0]| \le 1$.

### Пример 1:

Если для одного цветового канала ($q=0$) матрица значений:

$$
c(k)[0] = \begin{bmatrix}
0.1 & 0.5 & 0.2 \\
0.3 & -0.2 & 0.6 \\
0.7 & -0.7 & 0.9
\end{bmatrix}
$$

тогда вектор $X(k)$ будет выглядеть так:

$$
X(k) = \begin{bmatrix}
0.1 & 0.5 & 0.2 & 0.3 & -0.2 & 0.6 & 0.7 & -0.7 & 0.9
\end{bmatrix}
$$

Задача сжатия изображения сводится к обучению линейной рециркуляционной сети на выборке из $Q$ векторов $X(k)$ с последующим их прямым распространением через обученную рециркуляционную сеть с помощью матрицы весовых коэффициентов для прямого распространения $W_f$. После этого значения, полученные на втором слое, могут быть сохранены вместе с матрицей весовых коэффициентов для обратного распространения $W_b$ и ее размерностью.

Задача восстановления сводится к обратному распространению через обученную линейную рециркуляционную сеть сохранённых в виде $Q$ векторов значений второго слоя с помощью матрицы весовых коэффициентов для обратного распространения $W_b$.

Восстановленные данные в виде вектора $XX(k)$ могут быть использованы для воспроизведения изображения с помощью преобразования:

$$
C(k)[q][i][j] \approx \frac{C_{max} \cdot (\min(1, \max(-1, XX(k)[0][q+|S|\cdot(j+m\cdot i)])) + 1)}{2} \quad (2)
$$

Коэффициент сжатия может быть рассчитан как отношение размера исходных данных к размеру данных, полученных в результате сжатия.

Если разрядность исходных данных, элементов матриц, входных и сохранённых значений совпадает, то коэффициент сжатия может быть рассчитан по формуле:

$$
Z(Q, n, p) = \frac{Q \cdot n}{2 + (n+Q) \cdot p}
$$

Значение $p$ задает пользователь, исходя из того, чтобы $Z(Q, n, p)$ превышал единицу.

# Требования и порядок выполнения лабораторной работы:
1. Продумать вариант решения задачи.
2. Выбрать и описать структуру данных для хранения получаемых и обрабатываемых данных.
3. Указать авторство во всех файлах в заданном формате указания авторства.
4. Запрограммировать процедуры ввода и обработки данных, представления соответствующими структурами, и оформить блок-схемы основных алгоритмов, прокомментировать код.
5. Тестирование и отладка текущей реализации и повтор при необходимости шагов 1-4.
6. Оформить отчёт о выполненной работе, включающий:
   - титульный лист;
   - описание лабораторной, её темы и цели;
   - постановку задачи и дополнительные теоретические сведения к ней;
   - описание модели: краткое описание особенностей;
   - при необходимости – описание реализации с блок-схемами алгоритмов или ссылками на них;
   - исходные данные;
   - результаты счета и времена их получения; описание результатов тестирования и отладки;
   - графики (по 2 семейства графиков для величины каждого вида);
   - вопросы и ответы на них;
   - заключение (выводы);
   - список ссылок на использованные материалы и источники;
   - технческий стиль оформления отчёта предполагает: отсутствие прямых утверждений от первого лица, в том числе включающих местоимение первого лица; наличие ссылок на результаты коллег с указанием авторства; отсутствие предметно не подпадающих под тему отчёта повествований, включая личный чувственный опыт; использование строго определенных технических и математических терминов с минимально достаточным для изложения количеством, при аналитическом сравнении полагание в первую очередь на количественные признаки и метрические шкалы, для неметрических признаков должна быть строго задана модель шкалы; максимальное приближение результатов анализа к «объективным», указание на используемые модели и методы решения задач, включая анализ погрешности и единообразие оформления; полноту и правильность, соответствие принятым стандартам оформления рисунков, графиков, формул, таблиц; минимизацию числа орфографических, пунктуационных и иных синтаксических ошибок, отсутствие формулировок без смысла и с нерелевантным смыслом, включая неоднозначные формулировки.


## Варианты заданий по третьей лабораторной работе.
1. Реализовать модель линейной рециркуляционной сети с постоянным коэффициентом обучения с ненормированными весами.
2. Реализовать модель линейной рециркуляционной сети с адаптивным коэффициентом обучения с ненормированными весами.
3. Реализовать модель линейной рециркуляционной сети с постоянным коэффициентом обучения с нормированными весами.
4. Реализовать модель линейной рециркуляционной сети с адаптивным коэффициентом обучения с нормированными весами.
5. Реализовать модель линейной рециркуляционной сети с постоянным коэффициентом обучения с ненормированными весами.
6. Реализовать модель линейной рециркуляционной сети с адаптивным коэффициентом обучения с ненормированными весами.
7. Реализовать модель линейной рециркуляционной сети с постоянным коэффициентом обучения с нормированными весами.
8. Реализовать модель линейной рециркуляционной сети с адаптивным коэффициентом обучения с нормированными весами.
9. Реализовать модель линейной рециркуляционной сети с постоянным коэффициентом обучения с ненормированными весами.
10. Реализовать модель линейной рециркуляционной сети с адаптивным коэффициентом обучения с ненормированными весами.
11. Реализовать модель линейной рециркуляционной сети с постоянным коэффициентом обучения с нормированными весами.
12. Реализовать модель линейной рециркуляционной сети с адаптивным коэффициентом обучения с нормированными весами.
13. Реализовать модель линейной рециркуляционной сети с постоянным коэффициентом обучения с ненормированными весами.
14. Реализовать модель линейной рециркуляционной сети с адаптивным коэффициентом обучения с ненормированными весами.
15. Реализовать модель линейной рециркуляционной сети с постоянным коэффициентом обучения с нормированными весами.
16. Реализовать модель линейной рециркуляционной сети с адаптивным коэффициентом обучения с нормированными весами.
